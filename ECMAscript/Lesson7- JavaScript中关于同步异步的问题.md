# 第七讲 JavaScript中关于同步异步的问题

参考博客：https://blog.csdn.net/weixin_42839080/article/details/82989200

​        JavaScript的单线程，与它的用途有关。作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。这决定了它只能是单线程，否则会带来很复杂的同步问题。比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？

单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。如果前一个任务耗时很长，后一个任务就不得不一直等着。于是就有一个概念，**任务队列**。

如果排队是因为计算量大，CPU忙不过来，倒也算了，但是很多时候CPU是闲着的，因为IO设备（输入输出设备）很慢（比如Ajax操作从网络读取数据），不得不等着结果出来，再往下执行。

JavaScript语言的设计者意识到，这时主线程完全可以不管IO设备，挂起处于等待中的任务，先运行排在后面的任务。等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。

于是，所有任务可以分成两种，一种是同步任务（synchronous），另一种是异步任务（asynchronous）。**同步任务**指的是，在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；**异步任务**指的是，不进入主线程、而进入"任务队列"（task queue）的任务，只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。

![在这里插入图片描述](https://img-blog.csdn.net/20181009210333252?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjgzOTA4MA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

## 区别总结

> **执行时机不同**:：同步代码会一步一步的执行,而异步代码不会等后面的后面的代码执行,会自己先执行。
>
> **获取结果方式不同**：同步是函数的返回值,异步是回调函数。

## js中有哪些异步处理

- 定时器
- 事件函数
- ajax
- 回调函数（不全是）
- promise
- Generator函数

### 定时器

js中的定时器,是异步代码,也就是说程序会先执行同步代码,当定时器时间到了之后,通知主线程来执行同步代码.(相当于开启了一个线程)

`````js
function fun() {
		var name = '李四';
		setTimeout(function () {
			name = '张三';
		},2000)
		return name;
}
	var name = fun();
	console.log(name);
`````

### ajax

### 事件函数

事件同样具有异步性,因为事件只有等待触发之后,才会执行,事件触发形式通常会用于表示某些状态变化（加载、出错、进度变化、收到消息等等）
如果一开始主线程上就有同步代码,同样会先执行同步代码,直到事件触发后才会执行事件函数

这个例子里面: 函数调用时先于事件触发的,函数调用完后,便不会再去调用了,所以打印的还是李四.

`````js
function fun() {
	var name = '李四';
	div.addEventListener('click', function () {
		name = '张三';
	});
	return name;
}
var name = fun();
console.log(name);
`````

